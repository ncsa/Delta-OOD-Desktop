echo start before
if [ -z ${HOME+x} ];
then
    export HOME=$(echo ~)
	source /etc/profile
	source /etc/bashrc
	source $HOME/.bashrc
fi

# Export the module function if it exists
[[ $(type -t module) == "function" ]] && export -f module
hostname
pwd

# Apptainer is in path by default
#module load containers/singularity

## some singularity cleanup
unset APPTAINER_TMPDIR
export APPTAINERENV_LD_LIBRARY_PATH=$LD_LIBRARY_PATH

export TMPDIR=/scratch/bbka/yanzhan2/tmp
mkdir $TMPDIR/varlibxkb
apptainer run --cleanenv --nv \
    --bind `pwd`:/cwd,$TMPDIR:/TMPDIR,$TMPDIR/varlibxkb:/var/lib/xkb,/scratch \
    /u/yanzhan2/scratch/Delta-OOD-Desktop/Singularityfiles/desktop-test.sif -d "Desktop-$(hostname)" &
